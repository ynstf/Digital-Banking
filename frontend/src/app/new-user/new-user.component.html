<div class="cyber-container">
  <div class="form">
    <h1>Create New User</h1>
    
    <div *ngIf="errorMessage" class="alert alert-danger">
      {{ errorMessage }}
    </div>

    <form [formGroup]="userForm" (ngSubmit)="onSubmit()">
      <!-- Username Field -->
      <div class="control">
        <div class="block-cube block-input">
          <input 
            type="text" 
            class="form-control" 
            formControlName="username" 
            placeholder="Enter username"
            autocomplete="username"
          />
          <div class="bg-top">
            <div class="bg-inner"></div>
          </div>
          <div class="bg-right">
            <div class="bg-inner"></div>
          </div>
          <div class="bg">
            <div class="bg-inner"></div>
          </div>
        </div>
        <div *ngIf="userForm.get('username')?.invalid && userForm.get('username')?.touched" 
             class="error-message">
          <span class="error-icon">⚠</span>
          Username is required.
        </div>
      </div>

      <!-- Password Field -->
      <div class="control">
        <div class="block-cube block-input">
          <input 
            type="password" 
            class="form-control" 
            formControlName="password" 
            placeholder="Enter password"
            autocomplete="new-password"
          />
          <div class="bg-top">
            <div class="bg-inner"></div>
          </div>
          <div class="bg-right">
            <div class="bg-inner"></div>
          </div>
          <div class="bg">
            <div class="bg-inner"></div>
          </div>
        </div>
        <div *ngIf="userForm.get('password')?.invalid && userForm.get('password')?.touched" 
             class="error-message">
          <span class="error-icon">⚠</span>
          Password is required.
        </div>
      </div>

      <!-- Roles Section -->
      <div class="control roles-section">
        <label class="roles-label">
          <span class="label-text">Select Roles</span>
          <span class="label-glow"></span>
        </label>
        
        <div class="roles-container" formArrayName="roles">
          <div *ngFor="let roleCtrl of rolesFormArray.controls; let i = index" 
               class="role-item">
            <div class="cyber-checkbox">
              <input 
                type="checkbox" 
                class="checkbox-input" 
                [formControlName]="i" 
                [id]="'role-' + i"
              />
              <label [for]="'role-' + i" class="checkbox-label">
                <span class="checkbox-custom">
                  <span class="checkbox-inner"></span>
                </span>
                <span class="checkbox-text">{{ rolesList[i] }}</span>
              </label>
            </div>
          </div>
        </div>
        
        <div *ngIf="rolesFormArray.errors?.['required'] && rolesFormArray.touched" 
             class="error-message">
          <span class="error-icon">⚠</span>
          At least one role must be selected.
        </div>
      </div>



     <button 
      type="submit" 
      class="btn block-cube block-cube-hover" 
      [disabled]="!userForm.valid"
    >
      <div class="bg-top">
        <div class="bg-inner"></div>
      </div>
      <div class="bg-right">
        <div class="bg-inner"></div>
      </div>
      <div class="bg">
        <div class="bg-inner"></div>
      </div>
      <div class="text">
        Create User
      </div>
    </button>
    </form>
  </div>
</div>